import{v as Fe,k as Pe,w as Ee,x as z,y as Le,z as Ie,A as we,E as _e,G as ke,H as Te,J as Me,K as Re,L as De,M as $e,N as Oe,j as e,O as Be,Q as W,u as Ne,a as Ae,r as n,m as I,B as g,T as i,P as ee,b as qe,R as ze,U as We,V as te,W as A,C as Ve,X as He,F as Ue,I as Qe,S as Ge}from"./index-D1WZwRG5.js";import{C as se}from"./Chip-BcfuiGLT.js";import{A as Ke,M as Je,g as Xe}from"./mockContactPhoto-D_ACF6zO.js";import{B as w}from"./Button-BhZ-lD3l.js";import{A as Ye}from"./Add-CgRR7ozh.js";import{T as Ze,a as et,S as tt}from"./TablePagination-Bzp67lwk.js";import{D as rt}from"./Delete-Bp94XDaL.js";import{F as ot}from"./FileDownload-xGpG_pRF.js";import{A as at}from"./Alert-C2uN4Clt.js";import{T as st,a as nt,b as lt,c as _,d as a,e as ct}from"./TableRow-CbZqZsXt.js";import{C as re}from"./Checkbox-CkPVwaBf.js";import{M as d}from"./MenuItem-C9hTkJKZ.js";import{D as it}from"./Drawer-7E5gQ_7V.js";import{S as dt}from"./Stack-BDxuP9_X.js";import"./KeyboardArrowRight-DRYK2Ozh.js";import"./SwitchBase-TQvPBqmb.js";function ut(s,u){return()=>null}function ht(s,u){return()=>null}function xt(s,u,c,k,x){return null}const pt={configure:s=>{Fe.configure(s)}},mt=Object.freeze(Object.defineProperty({__proto__:null,capitalize:Pe,createChainedFunction:Ee,createSvgIcon:z,debounce:Le,deprecatedPropType:ut,isMuiElement:Ie,ownerDocument:we,ownerWindow:_e,requirePropFactory:ht,setRef:ke,unstable_ClassNameGenerator:pt,unstable_useEnhancedEffect:Te,unstable_useId:Me,unsupportedProp:xt,useControlled:Re,useEventCallback:De,useForkRef:$e,useIsFocusVisible:Oe},Symbol.toStringTag,{value:"Module"})),gt=z(e.jsx("path",{d:"M10 18h4v-2h-4zM3 6v2h18V6zm3 7h12v-2H6z"}),"FilterList"),ft=z(e.jsx("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreVert");var V={},q={};const jt=Be(mt);var oe;function H(){return oe||(oe=1,function(s){"use client";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return u.createSvgIcon}});var u=jt}(q)),q}var bt=W;Object.defineProperty(V,"__esModule",{value:!0});var ne=V.default=void 0,vt=bt(H()),ae=e;ne=V.default=(0,vt.default)([(0,ae.jsx)("path",{d:"m12 12.9-2.13 2.09c-.56.56-.87 1.29-.87 2.07C9 18.68 10.35 20 12 20s3-1.32 3-2.94c0-.78-.31-1.52-.87-2.07z"},"0"),(0,ae.jsx)("path",{d:"m16 6-.44.55C14.38 8.02 12 7.19 12 5.3V2S4 6 4 13c0 2.92 1.56 5.47 3.89 6.86-.56-.79-.89-1.76-.89-2.8 0-1.32.52-2.56 1.47-3.5L12 10.1l3.53 3.47c.95.93 1.47 2.17 1.47 3.5 0 1.02-.31 1.96-.85 2.75 1.89-1.15 3.29-3.06 3.71-5.3.66-3.55-1.07-6.9-3.86-8.52"},"1")],"LocalFireDepartment");var U={},Ct=W;Object.defineProperty(U,"__esModule",{value:!0});var le=U.default=void 0,St=Ct(H()),yt=e;le=U.default=(0,St.default)((0,yt.jsx)("path",{d:"M11 21h-1l1-7H7.5c-.58 0-.57-.32-.38-.66.19-.34.05-.08.07-.12C8.48 10.94 10.42 7.54 13 3h1l-1 7h3.5c.49 0 .56.33.47.51l-.07.15C12.96 17.55 11 21 11 21"}),"Bolt");var Q={},Ft=W;Object.defineProperty(Q,"__esModule",{value:!0});var ce=Q.default=void 0,Pt=Ft(H()),Et=e;ce=Q.default=(0,Pt.default)((0,Et.jsx)("path",{d:"M22 11h-4.17l3.24-3.24-1.41-1.42L15 11h-2V9l4.66-4.66-1.42-1.41L13 6.17V2h-2v4.17L7.76 2.93 6.34 4.34 11 9v2H9L4.34 6.34 2.93 7.76 6.17 11H2v2h4.17l-3.24 3.24 1.41 1.42L9 13h2v2l-4.66 4.66 1.42 1.41L11 17.83V22h2v-4.17l3.24 3.24 1.42-1.41L13 15v-2h2l4.66 4.66 1.41-1.42L17.83 13H22z"}),"AcUnit");const Lt=({score:s,size:u="medium",showIcon:c=!0})=>{const x=(p=>p>=70?{label:`${p} ðŸ”¥`,color:"#E53E3E",textColor:"#FFFFFF",icon:e.jsx(ne,{sx:{fontSize:16}}),classification:"Hot"}:p>=40?{label:`${p} âš¡`,color:"#FFB800",textColor:"#000000",icon:e.jsx(le,{sx:{fontSize:16}}),classification:"Warm"}:{label:`${p} â„ï¸`,color:"#00B4D8",textColor:"#FFFFFF",icon:e.jsx(ce,{sx:{fontSize:16}}),classification:"Cold"})(s);return e.jsx(se,{label:x.label,icon:c?x.icon:void 0,size:u,sx:{backgroundColor:x.color,color:x.textColor,fontWeight:600,"& .MuiChip-icon":{color:x.textColor}}})},It={subscriber:{label:"Subscriber",color:"#6B7280",bgColor:"#F3F4F6"},lead:{label:"Lead",color:"#00B4D8",bgColor:"#E0F7FA"},mql:{label:"MQL",color:"#FFB800",bgColor:"#FFF8E1"},sql:{label:"SQL",color:"#FF8C00",bgColor:"#FFE0B2"},opportunity:{label:"Opportunity",color:"#0052CC",bgColor:"#E3F2FD"},customer:{label:"Customer",color:"#00B341",bgColor:"#E8F5E9"},evangelist:{label:"Evangelist",color:"#9C27B0",bgColor:"#F3E5F5"}},wt=({stage:s,size:u="medium"})=>{const c=It[s];return e.jsx(se,{label:c.label,size:u,sx:{backgroundColor:c.bgColor,color:c.color,fontWeight:600,border:`1px solid ${c.color}30`}})},Ut=()=>{const s=Ne(),[u]=Ae(),[c,k]=n.useState([]),[x,p]=n.useState(!0),[G,T]=n.useState(null),[y,ie]=n.useState(""),[M,R]=n.useState(0),[D,de]=n.useState(20),[K,ue]=n.useState(0),[b,F]=n.useState([]),[J,X]=n.useState(null),[o,Y]=n.useState(null),[he,$]=n.useState(!1),[P,O]=n.useState(""),[j,Z]=n.useState([0,100]);n.useEffect(()=>{E()},[M,D,y,P,j]),n.useEffect(()=>{const t=u.get("lifecycleStage");(t==="subscriber"||t==="lead"||t==="mql"||t==="sql"||t==="opportunity"||t==="customer"||t==="evangelist")&&O(t)},[u]);const E=async()=>{var t,r;try{p(!0),T(null);const l={search:y,leadScoreMin:j[0],leadScoreMax:j[1]};P&&(l.lifecycleStage=[P]);const f=await I.contacts.list(l,M+1,D);k(((t=f.data)==null?void 0:t.data)||[]),ue(((r=f.data)==null?void 0:r.pagination.total)||0)}catch(l){T(l instanceof Error?l.message:"Erro ao carregar contatos")}finally{p(!1)}},xe=t=>{ie(t.target.value),R(0)},pe=t=>{t.target.checked?F(c.map(r=>r.id)):F([])},me=t=>{F(r=>r.includes(t)?r.filter(l=>l!==t):[...r,t])},ge=(t,r)=>{X(t.currentTarget),Y(r)},v=()=>{X(null),Y(null)},fe=()=>{s("/contacts/new")},je=async t=>{try{await I.contacts.delete(t),E(),v()}catch(r){alert(r instanceof Error?r.message:"Erro ao deletar contato")}},be=async()=>{if(window.confirm(`Deseja deletar ${b.length} contato(s) selecionado(s)?`))try{await I.contacts.bulkDelete(b),F([]),E()}catch(t){alert(t instanceof Error?t.message:"Erro ao deletar contatos")}},ve=()=>{const t=c.filter(h=>b.includes(h.id));if(!t.length)return;const r=["Nome","Email","Cargo","Empresa","Score","Lifecycle"],l=t.map(h=>{var L;return[h.fullName,h.email,h.jobTitle||"",((L=h.account)==null?void 0:L.name)||"",String(h.leadScore),h.lifecycleStage]}),f=[r,...l].map(h=>h.map(L=>`"${L.replace(/"/g,'""')}"`).join(",")).join(`
`),m=new Blob([f],{type:"text/csv;charset=utf-8;"}),S=URL.createObjectURL(m),N=document.createElement("a");N.href=S,N.download=`contatos_${new Date().toISOString().slice(0,10)}.csv`,N.click(),URL.revokeObjectURL(S)},Ce=(t,r)=>{R(r)},Se=t=>{de(parseInt(t.target.value,10)),R(0)},ye=t=>b.includes(t),C=b.length,B=c.length;return e.jsxs(g,{sx:{p:3},children:[e.jsxs(g,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(g,{children:[e.jsx(i,{variant:"h4",sx:{fontWeight:700,mb:.5},children:"ðŸ‘¥ Contatos"}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:[K," contato(s) no total"]})]}),e.jsxs(g,{sx:{display:"flex",gap:2},children:[e.jsx(w,{variant:"outlined",startIcon:e.jsx(gt,{}),sx:{borderRadius:2},onClick:()=>$(!0),children:"Filtros"}),e.jsx(w,{variant:"contained",startIcon:e.jsx(Ye,{}),sx:{borderRadius:2},onClick:fe,children:"Novo Contato"})]})]}),e.jsx(ee,{sx:{p:2,mb:3},children:e.jsx(qe,{fullWidth:!0,placeholder:"ðŸ” Buscar contatos por nome, email ou cargo...",value:y,onChange:xe,InputProps:{startAdornment:e.jsx(ze,{position:"start",children:e.jsx(We,{color:"action"})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),C>0&&e.jsxs(Ze,{sx:{pl:2,pr:1,mb:2,borderRadius:2,bgcolor:"primary.light",color:"primary.contrastText"},children:[e.jsxs(i,{sx:{flex:"1 1 100%"},variant:"subtitle1",children:[C," selecionado(s)"]}),e.jsx(te,{title:"Deletar selecionados",children:e.jsx(A,{onClick:be,sx:{color:"inherit"},children:e.jsx(rt,{})})}),e.jsx(te,{title:"Exportar selecionados",children:e.jsx(A,{sx:{color:"inherit"},onClick:ve,children:e.jsx(ot,{})})})]}),G&&e.jsx(at,{severity:"error",sx:{mb:3},onClose:()=>T(null),children:G}),e.jsxs(st,{component:ee,sx:{borderRadius:3},children:[e.jsxs(nt,{children:[e.jsx(lt,{sx:{bgcolor:"grey.50"},children:e.jsxs(_,{children:[e.jsx(a,{padding:"checkbox",children:e.jsx(re,{indeterminate:C>0&&C<B,checked:B>0&&C===B,onChange:pe})}),e.jsx(a,{children:"Nome"}),e.jsx(a,{children:"Cargo"}),e.jsx(a,{children:"Empresa"}),e.jsx(a,{children:"Lead Score"}),e.jsx(a,{children:"Lifecycle"}),e.jsx(a,{children:"Owner"}),e.jsx(a,{align:"right",children:"AÃ§Ãµes"})]})}),e.jsx(ct,{children:x?e.jsx(_,{children:e.jsxs(a,{colSpan:8,align:"center",sx:{py:8},children:[e.jsx(Ve,{}),e.jsx(i,{variant:"body2",sx:{mt:2},children:"Carregando contatos..."})]})}):c.length===0?e.jsx(_,{children:e.jsx(a,{colSpan:8,align:"center",sx:{py:8},children:e.jsx(i,{variant:"body1",color:"text.secondary",children:y?"ðŸ” Nenhum contato encontrado com este filtro":"ðŸ‘¤ Nenhum contato cadastrado. Crie o primeiro!"})})}):c.map(t=>{var l,f;const r=ye(t.id);return e.jsxs(_,{hover:!0,selected:r,sx:{cursor:"pointer"},onClick:()=>s(`/contacts/${t.id}?edit=1`),children:[e.jsx(a,{padding:"checkbox",children:e.jsx(re,{checked:r,onClick:m=>m.stopPropagation(),onChange:()=>me(t.id)})}),e.jsx(a,{children:e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:1.2},children:[e.jsx(Ke,{src:Xe(t.id),alt:t.fullName,sx:{width:34,height:34},imgProps:{referrerPolicy:"no-referrer",onError:m=>{const S=m.currentTarget;S.onerror=null,S.src=Je}}}),e.jsxs(g,{children:[e.jsx(i,{variant:"body2",sx:{fontWeight:600},children:t.fullName}),e.jsx(i,{variant:"caption",color:"text.secondary",sx:{display:"block"},children:t.email})]})]})}),e.jsx(a,{children:e.jsx(i,{variant:"body2",children:t.jobTitle||"â€”"})}),e.jsx(a,{children:e.jsx(i,{variant:"body2",children:((l=t.account)==null?void 0:l.name)||"â€”"})}),e.jsx(a,{children:e.jsx(Lt,{score:t.leadScore,size:"small"})}),e.jsx(a,{children:e.jsx(wt,{stage:t.lifecycleStage,size:"small"})}),e.jsx(a,{children:e.jsx(i,{variant:"body2",children:((f=t.owner)==null?void 0:f.fullName)||"â€”"})}),e.jsx(a,{align:"right",children:e.jsx(A,{size:"small",onClick:m=>{m.stopPropagation(),ge(m,t)},children:e.jsx(ft,{})})})]},t.id)})})]}),e.jsx(et,{rowsPerPageOptions:[10,20,50,100],component:"div",count:K,rowsPerPage:D,page:M,onPageChange:Ce,onRowsPerPageChange:Se,labelRowsPerPage:"Itens por pÃ¡gina:",labelDisplayedRows:({from:t,to:r,count:l})=>`${t}-${r} de ${l}`})]}),e.jsxs(He,{anchorEl:J,open:!!J,onClose:v,children:[e.jsx(d,{onClick:()=>{o&&s(`/contacts/${o.id}`),v()},children:"ðŸ‘ï¸ Ver Detalhes"}),e.jsx(d,{onClick:()=>{o&&s(`/contacts/${o.id}?edit=1`),v()},children:"âœï¸ Editar"}),e.jsx(d,{onClick:async()=>{if(o){const t={firstName:`${o.firstName} (CÃ³pia)`,lastName:o.lastName,email:`copia+${Date.now()}_${o.email}`,phone:o.phone,mobilePhone:o.mobilePhone,jobTitle:o.jobTitle,department:o.department,accountId:o.accountId,ownerId:o.ownerId,lifecycleStage:o.lifecycleStage,leadSource:o.leadSource,tags:o.tags};await I.contacts.create(t),await E()}v()},children:"ðŸ“‹ Duplicar"}),e.jsx(d,{onClick:()=>o&&je(o.id),sx:{color:"error.main"},children:"ðŸ—‘ï¸ Deletar"})]}),e.jsxs(it,{anchor:"right",open:he,onClose:()=>$(!1),PaperProps:{sx:{width:360,p:3}},children:[e.jsx(i,{variant:"h6",sx:{mb:2},children:"Filtros AvanÃ§ados"}),e.jsxs(dt,{spacing:3,children:[e.jsxs(Ue,{fullWidth:!0,children:[e.jsx(Qe,{children:"Lifecycle"}),e.jsxs(Ge,{label:"Lifecycle",value:P,onChange:t=>O(t.target.value||""),children:[e.jsx(d,{value:"",children:"Todos"}),e.jsx(d,{value:"subscriber",children:"Subscriber"}),e.jsx(d,{value:"lead",children:"Lead"}),e.jsx(d,{value:"mql",children:"MQL"}),e.jsx(d,{value:"sql",children:"SQL"}),e.jsx(d,{value:"opportunity",children:"Opportunity"}),e.jsx(d,{value:"customer",children:"Customer"}),e.jsx(d,{value:"evangelist",children:"Evangelist"})]})]}),e.jsxs(g,{children:[e.jsxs(i,{variant:"body2",sx:{mb:1},children:["Faixa de Lead Score: ",j[0]," - ",j[1]]}),e.jsx(tt,{value:j,min:0,max:100,valueLabelDisplay:"auto",onChange:(t,r)=>Z(r)})]}),e.jsxs(g,{sx:{display:"flex",gap:1},children:[e.jsx(w,{variant:"outlined",fullWidth:!0,onClick:()=>{O(""),Z([0,100])},children:"Limpar"}),e.jsx(w,{variant:"contained",fullWidth:!0,onClick:()=>$(!1),children:"Aplicar"})]})]})]})]})};export{Ut as ContactsListPage,Ut as default};
