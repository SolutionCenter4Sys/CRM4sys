import{r as n,j as e,B as h,T as a,P as u,m as v}from"./index-D1WZwRG5.js";import{S as m}from"./Stack-BDxuP9_X.js";import{B as i}from"./Button-BhZ-lD3l.js";import{F as x}from"./FileDownload-xGpG_pRF.js";import{C as y}from"./Chip-BcfuiGLT.js";import{S as g}from"./Snackbar-8yKmYgF-.js";import{A as b}from"./Alert-C2uN4Clt.js";const I=()=>{const[l,c]=n.useState(!1),[s,f]=n.useState(null),[t,r]=n.useState({open:!1,message:"",severity:"success"}),d=async j=>{c(!0);try{const o={format:j,filters:{periodFrom:null,periodTo:null,userId:null,entityType:null,action:null,severity:null,query:"",page:1,pageSize:100},includeDiffs:!0,maskSensitive:!0,requestedByUserId:null},p=await v.compliance.requestComplianceExport(o);f(p.data||null),r({open:!0,message:p.message||"Exportação solicitada",severity:"success"})}catch(o){r({open:!0,message:o.message,severity:"error"})}finally{c(!1)}};return e.jsxs(h,{sx:{p:3},children:[e.jsx(a,{variant:"h4",fontWeight:700,sx:{mb:3},children:"Exportar Logs de Compliance"}),e.jsxs(u,{sx:{p:3},children:[e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Gere um arquivo com os logs de auditoria respeitando mascaramento de dados sensíveis."}),e.jsxs(m,{direction:"row",spacing:1,children:[e.jsx(i,{variant:"contained",startIcon:e.jsx(x,{}),onClick:()=>d("csv"),disabled:l,children:"Exportar CSV"}),e.jsx(i,{variant:"outlined",startIcon:e.jsx(x,{}),onClick:()=>d("xlsx"),disabled:l,children:"Exportar XLSX"})]}),s&&e.jsxs(u,{variant:"outlined",sx:{p:2,mt:2},children:[e.jsxs(m,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsx(a,{variant:"subtitle2",children:"Último job de exportação"}),e.jsx(y,{size:"small",label:s.status,color:s.status==="done"?"success":s.status==="error"?"error":"default"})]}),e.jsxs(a,{variant:"body2",sx:{mt:1},children:["Solicitado em: ",new Date(s.requestedAt).toLocaleString("pt-BR")]}),s.fileName&&e.jsxs(a,{variant:"body2",children:["Arquivo: ",s.fileName]}),s.downloadUrl&&e.jsx(i,{size:"small",sx:{mt:1},href:s.downloadUrl,target:"_blank",children:"Baixar arquivo"})]})]}),e.jsx(g,{open:t.open,autoHideDuration:3500,onClose:()=>r({...t,open:!1}),children:e.jsx(b,{severity:t.severity,variant:"filled",onClose:()=>r({...t,open:!1}),children:t.message})})]})};export{I as default};
