import{r as o,j as e,B as u,T as l,V as d,W as h,C,P as A,m as x}from"./index-D1WZwRG5.js";import{S as c}from"./Stack-BDxuP9_X.js";import{R}from"./Refresh-DrNglfqJ.js";import{B as S}from"./Button-BhZ-lD3l.js";import{A as T}from"./Add-CgRR7ozh.js";import{T as w,a as k,b as E,c as m,d as a,e as I}from"./TableRow-CbZqZsXt.js";import{C as f}from"./Chip-BcfuiGLT.js";import{S as z}from"./Switch-axFPc32Z.js";import{E as B}from"./Edit-DEHhOGnU.js";import{D as P}from"./Delete-Bp94XDaL.js";import{S as D}from"./Snackbar-8yKmYgF-.js";import{A as W}from"./Alert-C2uN4Clt.js";import"./SwitchBase-TQvPBqmb.js";const U=()=>{const[p,j]=o.useState(!0),[g,v]=o.useState([]),[i,r]=o.useState({open:!1,message:"",severity:"success"}),n=async()=>{j(!0);try{const s=await x.collections.listRules();v(s.data||[])}catch(s){r({open:!0,message:s.message||"Erro ao carregar réguas",severity:"error"})}finally{j(!1)}};o.useEffect(()=>{n()},[]);const y=async s=>{try{await x.collections.saveRule({...s,isActive:!s.isActive}),r({open:!0,message:`Régua ${s.isActive?"desativada":"ativada"}`,severity:"success"}),n()}catch(t){r({open:!0,message:t.message,severity:"error"})}},b=async s=>{if(confirm("Remover esta régua?"))try{await x.collections.removeRule(s),r({open:!0,message:"Régua removida",severity:"success"}),n()}catch(t){r({open:!0,message:t.message,severity:"error"})}};return e.jsxs(u,{sx:{p:3},children:[e.jsxs(c,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:3},children:[e.jsx(l,{variant:"h4",fontWeight:700,children:"Réguas de Cobrança"}),e.jsxs(c,{direction:"row",spacing:1,children:[e.jsx(d,{title:"Recarregar",children:e.jsx(h,{onClick:n,disabled:p,children:e.jsx(R,{})})}),e.jsx(S,{variant:"contained",startIcon:e.jsx(T,{}),onClick:()=>alert("Criar régua (MVP)"),children:"Nova Régua"})]})]}),p?e.jsx(u,{sx:{display:"flex",justifyContent:"center",py:6},children:e.jsx(C,{})}):e.jsx(w,{component:A,children:e.jsxs(k,{children:[e.jsx(E,{children:e.jsxs(m,{children:[e.jsx(a,{children:"Nome"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Etapas"}),e.jsx(a,{children:"Aplica-se a"}),e.jsx(a,{align:"center",children:"Ativa"}),e.jsx(a,{align:"center",children:"Ações"})]})}),e.jsx(I,{children:g.length===0?e.jsx(m,{children:e.jsx(a,{colSpan:6,align:"center",children:e.jsx(l,{variant:"body2",color:"text.secondary",sx:{py:3},children:"Nenhuma régua configurada"})})}):g.map(s=>e.jsxs(m,{hover:!0,children:[e.jsx(a,{children:e.jsx(l,{variant:"body2",fontWeight:600,children:s.name})}),e.jsx(a,{children:e.jsx(f,{label:s.isActive?"Ativa":"Inativa",color:s.isActive?"success":"default",size:"small"})}),e.jsxs(a,{children:[s.steps.length," etapas"]}),e.jsx(a,{children:e.jsx(c,{direction:"row",spacing:.5,flexWrap:"wrap",children:s.appliesToStatus.map(t=>e.jsx(f,{label:t,size:"small",variant:"outlined"},t))})}),e.jsx(a,{align:"center",children:e.jsx(z,{checked:s.isActive,onChange:()=>y(s)})}),e.jsx(a,{align:"center",children:e.jsxs(c,{direction:"row",spacing:.5,justifyContent:"center",children:[e.jsx(d,{title:"Editar",children:e.jsx(h,{size:"small",onClick:()=>alert("Editar régua (MVP)"),children:e.jsx(B,{fontSize:"small"})})}),e.jsx(d,{title:"Excluir",children:e.jsx(h,{size:"small",color:"error",onClick:()=>b(s.id),children:e.jsx(P,{fontSize:"small"})})})]})})]},s.id))})]})}),e.jsx(D,{open:i.open,autoHideDuration:4e3,onClose:()=>r({...i,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(W,{severity:i.severity,variant:"filled",onClose:()=>r({...i,open:!1}),children:i.message})})]})};export{U as default};
