import{r,j as e,B as g,T as i,V as d,W as h,C as A,P as k,b,m as P}from"./index-D1WZwRG5.js";import{S as l}from"./Stack-BDxuP9_X.js";import{R as I}from"./Refresh-DrNglfqJ.js";import{B as y}from"./Button-BhZ-lD3l.js";import{A as z}from"./Add-CgRR7ozh.js";import{T as E,a as V,b as W,c as m,d as a,e as B}from"./TableRow-CbZqZsXt.js";import{C as x}from"./Chip-BcfuiGLT.js";import{V as D}from"./Visibility-C5H_TSHc.js";import{E as O}from"./Edit-DEHhOGnU.js";import{D as R,a as M,b as F,c as N}from"./DialogTitle-CaeVllRe.js";import{S as H}from"./Snackbar-8yKmYgF-.js";import{A as L}from"./Alert-C2uN4Clt.js";const se=()=>{const[p,j]=r.useState(!0),[u,C]=r.useState([]),[T,o]=r.useState(!1),[t,S]=r.useState(null),[n,c]=r.useState({open:!1,message:"",severity:"success"}),f=async()=>{j(!0);try{const s=await P.collections.listTemplates();C(s.data||[])}catch(s){c({open:!0,message:s.message||"Erro ao carregar templates",severity:"error"})}finally{j(!1)}};r.useEffect(()=>{f()},[]);const w=s=>{S(s),o(!0)},v={email:"E-mail",sms:"SMS",whatsapp:"WhatsApp"};return e.jsxs(g,{sx:{p:3},children:[e.jsxs(l,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:3},children:[e.jsx(i,{variant:"h4",fontWeight:700,children:"Templates de Cobrança"}),e.jsxs(l,{direction:"row",spacing:1,children:[e.jsx(d,{title:"Recarregar",children:e.jsx(h,{onClick:f,disabled:p,children:e.jsx(I,{})})}),e.jsx(y,{variant:"contained",startIcon:e.jsx(z,{}),onClick:()=>alert("Criar template (MVP)"),children:"Novo Template"})]})]}),p?e.jsx(g,{sx:{display:"flex",justifyContent:"center",py:6},children:e.jsx(A,{})}):e.jsx(E,{component:k,children:e.jsxs(V,{children:[e.jsx(W,{children:e.jsxs(m,{children:[e.jsx(a,{children:"Nome"}),e.jsx(a,{children:"Canal"}),e.jsx(a,{children:"Versões"}),e.jsx(a,{children:"Status"}),e.jsx(a,{align:"center",children:"Ações"})]})}),e.jsx(B,{children:u.length===0?e.jsx(m,{children:e.jsx(a,{colSpan:5,align:"center",children:e.jsx(i,{variant:"body2",color:"text.secondary",sx:{py:3},children:"Nenhum template configurado"})})}):u.map(s=>e.jsxs(m,{hover:!0,children:[e.jsx(a,{children:e.jsx(i,{variant:"body2",fontWeight:600,children:s.name})}),e.jsx(a,{children:e.jsx(x,{label:v[s.channel],size:"small",variant:"outlined"})}),e.jsxs(a,{children:[s.versions.length," versões"]}),e.jsx(a,{children:e.jsx(x,{label:s.isActive?"Ativo":"Inativo",color:s.isActive?"success":"default",size:"small"})}),e.jsx(a,{align:"center",children:e.jsxs(l,{direction:"row",spacing:.5,justifyContent:"center",children:[e.jsx(d,{title:"Visualizar",children:e.jsx(h,{size:"small",onClick:()=>w(s),children:e.jsx(D,{fontSize:"small"})})}),e.jsx(d,{title:"Editar",children:e.jsx(h,{size:"small",onClick:()=>alert("Editar template (MVP)"),children:e.jsx(O,{fontSize:"small"})})})]})})]},s.id))})]})}),e.jsxs(R,{open:T,onClose:()=>o(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(M,{children:"Preview do Template"}),e.jsx(F,{children:t&&e.jsxs(l,{spacing:2,children:[e.jsx(i,{variant:"h6",children:t.name}),e.jsx(x,{label:v[t.channel],size:"small"}),t.versions.length>0&&e.jsxs(e.Fragment,{children:[t.channel==="email"&&t.versions[0].subject&&e.jsx(b,{label:"Assunto",fullWidth:!0,value:t.versions[0].subject,InputProps:{readOnly:!0}}),e.jsx(b,{label:"Corpo",fullWidth:!0,multiline:!0,rows:6,value:t.versions[0].body,InputProps:{readOnly:!0}}),e.jsxs(i,{variant:"caption",color:"text.secondary",children:["Variáveis disponíveis: ",t.variables.map(s=>s.key).join(", ")]})]})]})}),e.jsx(N,{children:e.jsx(y,{onClick:()=>o(!1),children:"Fechar"})})]}),e.jsx(H,{open:n.open,autoHideDuration:4e3,onClose:()=>c({...n,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(L,{severity:n.severity,variant:"filled",onClose:()=>c({...n,open:!1}),children:n.message})})]})};export{se as default};
